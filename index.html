<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>SAMI AI - Inicio</title>
  <link rel="stylesheet" href="styles.css">
  <script src="https://identity.netlify.com/v1/netlify-identity-widget.js"></script>
</head>
<body>

  <!-- üîê User Status & Auth Buttons -->
  <div id="user-status" style="position: fixed; top: 1rem; left: 1rem; z-index: 1000;">
    <span id="user-email" style="color: #fdb913;"></span>
    <button id="loginBtn" class="login-button">Iniciar Sesi√≥n</button>
    <button id="logoutBtn" class="login-button" style="display:none">Cerrar Sesi√≥n</button>
  </div>

  <!-- üí° Header SAMI AI -->
  <header>
    <h1>SAMI AI ‚Äì Men√∫ de Prompts</h1>
    <img src="RoboticPantherProwl_simple_compose_01-ezgif.com-loop-count-1.gif" alt="SAMI AI">
    <p><strong>SAMI AI</strong> es una herramienta impulsada por IA dise√±ada para ayudar a equipos de marketing, estrategia y desarrollo de productos a explorar ideas, detectar necesidades no satisfechas y aplicar marcos de innovaci√≥n adaptados a Latinoam√©rica.</p>
  </header>

  <!-- üîç Search + Filtros -->
  <button class="toggle-btn" onclick="toggleMode()">Modo Claro/Oscuro</button>
  <button class="lang-btn" onclick="toggleLang()">Espa√±ol / English</button>

  <div class="search-box">
    <input type="text" id="searchInput" onkeyup="filterPrompts()" placeholder="Buscar prompts...">
  </div>
  <div class="filters" id="categoryFilters"></div>
  <div class="grid" id="promptGrid"></div>

  <button id="chat-button" onclick="toggleIframe()">Ask SAMI AI</button>
  <iframe id="chat-iframe" src="https://chat.openai.com/g/g-W0JlyXEDn-sami-ai-advanced-analytical-tool" allow="clipboard-write"></iframe>

  <!-- üëá L√≥gica JavaScript -->
  <script>
    // Language toggle + Prompt categories
    let currentLang = 'es';
    let activeCategory = 'all';

    const prompts = {
      es: [
        { category: "üîç Descubrir Necesidades No Satisfechas", key: "needs", items: [
          "Identifica necesidades no satisfechas en la industria del bienestar",
          "¬øQu√© puntos de dolor existen hoy en la banca digital?",
          "Ay√∫dame a analizar retroalimentaci√≥n para detectar oportunidades ocultas"
        ]},
        { category: "üí° Generar Nuevos Conceptos", key: "concepts", items: [
          "Ideas innovadoras para viajeros Gen Z",
          "Servicios con IA para educaci√≥n remota",
          "Usa Blue Ocean Strategy para repensar los kits de comida"
        ]}
        // A√±ade m√°s si necesitas
      ],
      en: [
        { category: "üîç Discover Unmet Needs", key: "needs", items: [
          "Identify unmet customer needs in the wellness industry",
          "What pain points exist in digital banking today?",
          "Help me analyze user feedback to spot hidden opportunities"
        ]}
      ]
    };

    function renderFilters(lang) {
      const container = document.getElementById('categoryFilters');
      container.innerHTML = '';
      const allBtn = document.createElement('button');
      allBtn.className = 'filter-btn';
      allBtn.innerText = lang === 'es' ? 'Todos' : 'All';
      allBtn.onclick = () => { activeCategory = 'all'; renderPrompts(lang); };
      container.appendChild(allBtn);
      prompts[lang].forEach(section => {
        const btn = document.createElement('button');
        btn.className = 'filter-btn';
        btn.innerText = section.category;
        btn.onclick = () => { activeCategory = section.key; renderPrompts(lang); };
        container.appendChild(btn);
      });
    }

    function renderPrompts(lang) {
      const grid = document.getElementById('promptGrid');
      grid.innerHTML = '';
      prompts[lang].forEach(({ category, items, key }) => {
        if (activeCategory !== 'all' && activeCategory !== key) return;
        const card = document.createElement('div');
        card.className = 'card';
        const header = `<div class="category">${category}</div>`;
        const links = items.map(text => `<li><a href="chat.html?prompt=${encodeURIComponent(text)}">${text}</a></li>`).join('');
        card.innerHTML = `${header}<ul>${links}</ul>`;
        grid.appendChild(card);
      });
    }

    function toggleMode() {
      document.body.classList.toggle('light-mode');
    }

    function toggleLang() {
      currentLang = currentLang === 'es' ? 'en' : 'es';
      document.getElementById('searchInput').placeholder = currentLang === 'es' ? 'Buscar prompts...' : 'Search prompts...';
      renderFilters(currentLang); renderPrompts(currentLang);
    }

    function filterPrompts() {
      const input = document.getElementById('searchInput').value.toLowerCase();
      const cards = document.getElementsByClassName('card');
      for (let card of cards) {
        const text = card.textContent.toLowerCase();
        card.style.display = text.includes(input) ? '' : 'none';
      }
    }

    function toggleIframe() {
      const iframe = document.getElementById('chat-iframe');
      iframe.style.display = iframe.style.display === 'block' ? 'none' : 'block';
    }

    // Netlify Identity logic
    if (window.netlifyIdentity) {
      netlifyIdentity.on("init", user => updateUserUI(user));
      netlifyIdentity.on("login", user => updateUserUI(user));
      netlifyIdentity.on("logout", () => updateUserUI(null));
    }

    function updateUserUI(user) {
      const email = document.getElementById('user-email');
      const loginBtn = document.getElementById('loginBtn');
      const logoutBtn = document.getElementById('logoutBtn');

      if (user) {
        const roles = user.app_metadata.roles || [];
        email.textContent = `üëã Bienvenido, ${user.email} (${roles.join(', ')})`;
        loginBtn.style.display = 'none';
        logoutBtn.style.display = 'inline-block';
        if (roles.includes('admin')) enableAdminTools();
      } else {
        email.textContent = '';
        loginBtn.style.display = 'inline-block';
        logoutBtn.style.display = 'none';
      }
    }

    function enableAdminTools() {
      alert('üõ† Admin activo: puedes ver herramientas avanzadas aqu√≠.');
      // Aqu√≠ podr√≠as habilitar botones ocultos, links especiales, etc.
    }

    document.getElementById('loginBtn').addEventListener('click', () => {
      netlifyIdentity.open();
    });

    document.getElementById('logoutBtn').addEventListener('click', () => {
      netlifyIdentity.logout();
    });

    // Init
    renderFilters(currentLang);
    renderPrompts(currentLang);
  </script>
</body>
</html>
